<div class="container">
    <div class="page-header">
        <h1><i class="fas fa-users"></i> Student Management</h1>
        <div class="actions">
            <button class="btn btn-primary" onclick="toggleAddForm()">
                <i class="fas fa-plus"></i> Add Student
            </button>
            <button class="btn btn-success" onclick="toggleUploadForm()">
                <i class="fas fa-file-excel"></i> Import Excel
            </button>
            <form action="/delete-all-students" method="POST" onsubmit="return confirm('Are you sure you want to delete all students?');">
                 <button type="submit">Delete All Students</button>
            </form>
        </div>
    </div>

    <!-- Add Student Form -->
    <div id="addStudentForm" class="form-container" style="display: none;">
        <h3>Add New Student</h3>
        <form action="/add-student" method="POST">
            <div class="form-group">
                <label for="roll_no">Roll Number:</label>
                <input type="text" id="roll_no" name="roll_no" required>
            </div>
            <div class="form-group">
                <label for="name">Name:</label>
                <input type="text" id="name" name="name" required>
            </div>
            <div class="form-group">
                <label for="department">Department:</label>
                <select id="department" name="department" required>
                    <option value="">Select Department</option>
                    <option value="CSE">Computer Science Engineering</option>
                    <option value="ECE">Electronics & Communication</option>
                    <option value="MECH">Mechanical Engineering</option>
                    <option value="CIVIL">Civil Engineering</option>
                    <option value="EEE">Electrical Engineering</option>
                </select>
            </div>
            <div class="form-actions">
                <button type="submit" class="btn btn-primary">Add Student</button>
                <button type="button" class="btn btn-secondary" onclick="toggleAddForm()">Cancel</button>
            </div>
        </form>
    </div>

    <!-- Excel Upload Form -->
    <div id="uploadForm" class="form-container" style="display: none;">
        <h3>Import Students from Excel</h3>
        <form action="/upload-students" method="POST" enctype="multipart/form-data">
            <div class="form-group">
                <label for="excelFile">Choose Excel File:</label>
                <input type="file" id="excelFile" name="excelFile" accept=".xls,.xlsx" required>
            </div>
            <div class="form-actions">
                <button type="submit" class="btn btn-success">Upload</button>
                <button type="button" class="btn btn-secondary" onclick="toggleUploadForm()">Cancel</button>
            </div>
        </form>
    </div>

    <!-- Student List -->
    <div class="students-table">
        <h3>Student List</h3>
        <div class="table-container">
            <table>
                <thead>
                    <tr>
                        <th>Roll No</th>
                        <th>Name</th>
                        <th>Department</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <% students.forEach(student => { %>
                    <tr>
                        <td><%= student.roll_no %></td>
                        <td><%= student.name %></td>
                        <td>
                            <span class="dept-badge dept-<%= student.department ? student.department.toLowerCase() : 'unknown' %>">
                                 <%= student.department || 'Unknown' %>
                            </span>

                        </td>
                        <td><%= new Date(student.created_at).toLocaleDateString() %></td>
                        <td>
                            <form action="/delete-student/<%= student.id %>" method="POST" onsubmit="return confirm('Are you sure you want to delete this student?');">
                                <button type="submit" class="btn btn-danger btn-sm">
                                    <i class="fas fa-trash"></i> Delete
                                </button>
                            </form>
                        </td>
                    </tr>
                    <% }) %>
                </tbody>
            </table>
        </div>
    </div>
</div>

<script>
    function toggleAddForm() {
        const form = document.getElementById("addStudentForm");
        form.style.display = form.style.display === "none" ? "block" : "none";
    }
    function toggleUploadForm() {
        const form = document.getElementById("uploadForm");
        form.style.display = form.style.display === "none" ? "block" : "none";
    }
</script>
